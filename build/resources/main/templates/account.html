<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:sec="http://www.w3.org/1999/xhtml">
<head th:replace="layouts/layout :: head(${account.username + ' Automation'})"></head>

<body>
<div th:replace="layouts/layout :: alert"></div>

<nav th:replace="layouts/layout :: navigation-in"></nav>

<div class="container mt-4 px-1 mb-5" th:object="${account}">

    <div class="row text-center mx-1 mx-lg-0">

        <div class="col-12 col-lg-4 mb-4 px-0 px-lg-2">

            <!--####################PROFILE######################-->
            <div class="box py-4 px-3 mb-4">

                <a sec:authorize="hasRole('ROLE_ADMIN')" th:href="@{'https://instagram.com/' + *{username}}" target="_blank">
                    <img class="card-img-top img-fluid profile-pic rounded-circle mb-1" th:src="@{*{profilePic}}"/>
                </a>

                <img sec:authorize="!hasRole('ROLE_ADMIN')" class="card-img-top img-fluid profile-pic rounded-circle mb-1" th:src="@{*{profilePic}}"/>

                <p class="font-weight-500" th:text="*{username}"></p>

                <div class="row mb-3">
                    <div class="col">
                        <p class="mb-0">Followers</p>
                        <p class="h5 mb-0 font-weight-500 text-success" th:text="*{followers}"></p>
                    </div>
                    <div class="col border-left">
                        <p class="mb-0">Following</p>
                        <p class="h5 mb-0 font-weight-500" th:text="*{following}"></p>
                    </div>
                </div>


                <form th:if="*{running}" th:action="@{/automate/stop}" method="post" class="mb-2" th:object="${account}">
                    <input type="hidden" th:value="${account.id}" th:field="*{id}"/>
                    <input type="hidden" th:value="*{username}" th:field="*{username}"/>
                    <button type="submit" class="btn btn-outline-warning btn-block font-weight-500">Stop Activity</button>
                </form>

                <form th:unless="*{running}" th:action="@{/automate/start}" method="post" class="mb-2" th:object="${account}">
                    <input type="hidden" th:value="${account.id}" th:field="*{id}"/>
                    <input type="hidden" th:value="*{username}" th:field="*{username}"/>
                    <button type="submit" class="btn btn-primary btn-block font-weight-500">Start Activity</button>

                </form>

                <!-- Button trigger modal -->
                <button type="button" href="#" class="btn btn-outline-primary btn-block font-weight-500" data-toggle="modal" data-target="#settingsModal" data-backdrop="static">Account Settings</button>

                <a th:if="*{!pendingUpgrade}" th:href="@{'/account/' + *{username} + '?upgrade=true'}" class="btn btn-success btn-block font-weight-500">Upgrade Account</a>

                <!-- Modal -->
                <div class="modal fade" id="settingsModal" tabindex="-1" role="dialog" aria-labelledby="settingsModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <div class="w-100">
                                    <h5 class="modal-title text-center" id="exampleModalLabel">Settings</h5>
                                </div>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>

                            <div class="modal-body text-left mx-0 mx-sm-3">

                                <div id="settings-alert"></div>

                                <form id="settings" th:object="${setting}">
                                    <div class="row mb-4">
                                        <div class="col-12 col-lg-6 mb-3">
                                            <p class="font-weight-500 mb-0">Action Controls</p>
                                            <p class="text-secondary mb-3">Actions performed by your account</p>

                                                <!--<input id="input" type="text" th:field="*{id}" th:value="${id}"/>-->
                                                <input id="likes1" type="hidden" th:field="*{likes}" class="d-none"/>
                                                <input id="comment1" type="hidden" th:field="*{comment}" class="d-none"/>
                                                <input id="follow1" type="hidden" th:field="*{follow}" class="d-none"/>
                                                <input id="unfollow1" type="hidden" th:field="*{unfollow}" class="d-none"/>

                                            <div class="p-3 bg-light">
                                                <!--#########LIKES########-->
                                                <div class="row mb-2">
                                                    <div class="col my-auto d-flex">
                                                        <label class="switch mb-0">
                                                            <input id="likes2" type="checkbox"/>
                                                            <span class="slider round"></span>
                                                        </label>
                                                        <p class="ml-3 my-auto">Likes</p>
                                                    </div>
                                                    <div class="col my-auto">
                                                        <p class="text-right my-auto font-weight-500" th:text="${liked}">0</p>
                                                    </div>
                                                </div>


                                                <!--#########COMMENTS########-->
                                                <div class="row mb-2">
                                                    <div class="col my-auto d-flex">
                                                        <label class="switch mb-0">
                                                            <input id="comment2" type="checkbox"/>
                                                            <span class="slider round"></span>
                                                        </label>
                                                        <p class="ml-3 my-auto">Comments</p>
                                                    </div>
                                                    <div class="col my-auto">
                                                        <p class="text-right my-auto font-weight-500" th:text="${commented}">0</p>
                                                    </div>
                                                </div>

                                                <!--#########FOLLOWS########-->
                                                <div class="row mb-2">
                                                    <div class="col my-auto d-flex">
                                                        <label class="switch mb-0">
                                                            <input id="follow2" type="checkbox"/>
                                                            <span class="slider round"></span>
                                                        </label>
                                                        <p class="ml-3 my-auto">Follows</p>
                                                    </div>
                                                    <div class="col my-auto">
                                                        <p class="text-right my-auto font-weight-500" th:text="${following}">0</p>
                                                    </div>
                                                </div>

                                                <!--#########UNFOLLOWS########-->
                                                <div class="row mb-2">
                                                    <div class="col my-auto d-flex">
                                                        <label class="switch mb-0">
                                                            <input id="unfollow2" type="checkbox"/>
                                                            <span class="slider round"></span>
                                                        </label>
                                                        <p class="ml-3 my-auto">Unfollows</p>
                                                    </div>
                                                    <div class="col my-auto">
                                                        <p class="text-right my-auto font-weight-500" th:text="${unfollowed}">0</p>
                                                    </div>
                                                </div>

                                                <!--#########POSTS########-->
                                                <div class="row mb-2">
                                                    <div class="col my-auto d-flex">
                                                        <label class="switch mb-0">
                                                            <input type="checkbox" disabled="true"/>
                                                            <span class="slider round round-disabled" disabled="true"></span>
                                                        </label>
                                                        <p class="ml-3 my-auto">Posts</p>
                                                    </div>
                                                    <div class="col my-auto">
                                                        <p class="text-right my-auto font-weight-500" th:text="${posted}">0</p>
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <!--####################SCHEDULED POSTS######################-->

                                        <div class="col-12 col-lg-6 mb-3">
                                            <p class="font-weight-500 mb-0">Schedule Posts (Coming soon)</p>
                                            <p class="text-secondary mb-3">Upload and schedule the future posts</p>

                                            <div class="form p-3 bg-light">
                                                <div class="row mb-3">
                                                    <div class="col-5 d-flex">
                                                        <p class="my-auto mr-2">Post time</p>
                                                        <p class="help" data-toggle="tooltip" data-placement="right" title="Tooltip on right">?</p>
                                                    </div>
                                                    <div class="col">
                                                        <div class="input-group">
                                                            <input type="time" class="form-control" id="start-time" disabled="true"/>
                                                            <div class="input-group-append">
                                                                <select class="custom-select my-auto" disabled="true">
                                                                    <option>AM</option>
                                                                    <option>PM</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <input type="text" class="form-control mb-3" placeholder="caption" disabled="true"/>

                                                <div class="input-group mb-3">
                                                    <div class="custom-file">
                                                        <input type="file" class="custom-file-input" id="inputGroupFile04" disabled="true" />
                                                        <label class="custom-file-label" for="inputGroupFile04">Choose file</label>
                                                    </div>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-outline-secondary" type="button" disabled="true">Upload</button>
                                                    </div>
                                                </div>

                                                <button type="button" class="btn btn-outline-info btn-block" disabled="true">View All Posts</button>


                                            </div>
                                        </div>
                                    </div>

                                    <hr class="w-75 mb-4 mt-3"/>


                                    <!--####################MAIN SETTINGS######################-->

                                    <div class="mb-3">
                                        <p class="font-weight-500 mb-0">Main Settings</p>
                                        <p class="mb-3 text-secondary">Toggle with your accounts automation settings</p>

                                            <input type="hidden" th:value="*{actionSpeed}" id="action-speed-val"/>
                                            <input type="hidden" th:value="*{mediaType}" id="media-type-val"/>

                                            <div class="row mx-0 bg-light pt-3">
                                                <div class="col-12 col-lg-6 mb-3">

                                                    <div class="row">
                                                        <div class="col d-flex">
                                                            <p class="my-auto mr-2">Action Speed</p>
                                                            <p class="help" data-toggle="tooltip" data-placement="right" title="Tooltip on right">?</p>
                                                        </div>
                                                        <div class="col">
                                                            <select class="custom-select my-auto" id="action-speed">
                                                                <option>Slow</option>
                                                                <option>Normal</option>
                                                                <option>Fast</option>
                                                            </select>
                                                        </div>
                                                    </div>


                                                </div>

                                                <div class="col-12 col-lg-6 mb-3">

                                                    <div class="row">
                                                        <div class="col d-flex">
                                                            <p class="my-auto mr-2">Media Type</p>
                                                            <p class="help" data-toggle="tooltip" data-placement="right" title="Tooltip on right">?</p>
                                                        </div>
                                                        <div class="col">
                                                            <select class="custom-select my-auto" id="media-type">
                                                                <option>All</option>
                                                                <option>Images</option>
                                                                <option>Video</option>
                                                            </select>
                                                        </div>
                                                    </div>

                                                </div>

                                                <div class="col-12 col-lg-6 mb-3">

                                                    <div class="row">
                                                        <div class="col d-flex">
                                                            <p class="my-auto mr-2">Min. likes filter</p>
                                                            <p class="help" data-toggle="tooltip" data-placement="right" title="Tooltip on right">?</p>
                                                        </div>
                                                        <div class="col">
                                                            <input type="number" min="0" class="form-control" id="min-likes-filter" th:value="*{minLikesFilter}"/>
                                                        </div>
                                                    </div>

                                                </div>

                                                <div class="col-12 col-lg-6 mb-3">

                                                    <div class="row">
                                                        <div class="col d-flex">
                                                            <p class="my-auto mr-2">Max. likes filter</p>
                                                            <p class="help" data-toggle="tooltip" data-placement="right" title="Tooltip on right">?</p>
                                                        </div>
                                                        <div class="col">
                                                            <input type="number" min="0" class="form-control" id="max-likes-filter" th:value="*{maxLikesFilter}"/>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                    </div>
                                </form>

                                <div id="seed-settings-alert"></div>

                                <div class="row bg-light pt-3 mb-3 mx-0">

                                    <div class="col-12 col-lg-6 mb-3">
                                        <div id="username-settings" class="row">
                                            <div class="col d-flex">
                                                <p class="my-auto mr-2">Usernames:</p>
                                                <p class="help" data-toggle="tooltip" data-placement="right" title="Tooltip on right">?</p>
                                            </div>
                                            <div class="col">
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder="@username" id="seed-username-name"/>
                                                    <input type="hidden" id="seed-username-account" th:value="${account.id}"/>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-outline-secondary" type="button" id="seed-username-add">Add</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-12 col-lg-6 mb-3">
                                        <div id="usernames" class="row text-secondary">
                                            <div class="col-6 col-lg-4 px-0 text-center" th:each="username : ${usernames}">
                                                <span th:text="${'@' + username.name}"></span>
                                                <a href="#" class="ml-1 text-danger font-weight-500" th:id="${'seed-' + username.id}">x</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row bg-light pt-3 mb-3 mx-0">
                                    <div class="col-12 col-lg-6 mb-3">
                                        <div id="tag-settings" class="row">
                                            <div class="col d-flex">
                                                <p class="my-auto mr-2">Tags:</p>
                                                <p class="help" data-toggle="tooltip" data-placement="right" title="Tooltip on right">?</p>
                                            </div>
                                            <div class="col">
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder="#tag" id="seed-tag-name" />
                                                    <input type="hidden" id="seed-tag-account" th:value="${account.id}"/>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-outline-secondary" type="button" id="seed-tag-add">Add</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-lg-6 mb-3">
                                        <div id="tags" class="row text-secondary">
                                            <div class="col-6 col-lg-4 px-0 text-center" th:each="tag : ${tags}">
                                                <span th:text="${'#' + tag.name}"></span>
                                                <a href="#" class="ml-1 text-danger font-weight-500" th:id="${'seed-' + tag.id}">x</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <hr class="w-75 my-4"/>

                                <!--####################COMMENTS######################-->

                                <div>
                                    <p class="font-weight-500 mb-0">Comments</p>
                                    <p class="mb-3 text-secondary">Comments that will be posted on your behalf, if enabled</p>

                                    <div id="comment-settings" class="p-3 bg-light">

                                        <div id="comments">
                                            <p class="mb-1 text-secondary text-center" th:each="comment : ${comments}">
                                                <span th:text="${comment.description}"></span>
                                                <a href="#" class="ml-1 text-danger font-weight-500" th:id="${'comment-' + comment.id}">x</a>
                                            </p>
                                        </div>

                                        <input type="text" class="form-control mb-2 mt-3" placeholder="Enter comment..." id="comment"/>
                                        <input type="hidden" id="comment-account" th:value="${account.id}"/>
                                        <button type="button" class="btn btn-secondary btn-block" id="comment-add">Add Comment</button>
                                    </div>
                                </div>




                            </div> <!--###BODY END###-->


                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <!--####################UPGRADE ACCOUNT######################-->


            <div th:unless="*{enabled}" class="box py-4 px-3 mb-4">
                <a th:href="@{'https://instagram.com/' + *{username}}" target="_blank">
                    <img class="card-img-top img-fluid profile-pic rounded-circle mb-1" th:src="@{*{profilePic}}"/>
                </a>
                <p class="font-weight-500" th:text="*{username}"></p>

                <span class="font-weight-500 bg-warning px-3 py-2 rounded text-white">Account Expired</span>
            </div>


            <!--####################LATEST ACTIONS######################-->

            <div class="box pt-4 text-left">
                <div class="px-3">
                    <p class="font-weight-500 mb-1">Latest Actions</p>
                    <p class="span text-secondary">Latest actions performed</p>
                </div>
                <div class="activity" style="max-height:200px;">
                    <p th:if="${latestActions.isEmpty()}" class="text-secondary text-center my-5">No actions completed...</p>

                    <div th:unless="${latestActions.isEmpty()}" th:each="action : ${latestActions}" class="border-bottom">
                        <p class="text-left px-3 py-0 my-2" th:text="${action.description}"></p>
                    </div>
                </div>
            </div>

        </div>

<!--###################################################LEFT COL END##################################################-->

        <div class="col-12 col-lg-8 px-0 px-lg-3">

            <!--####################FOLLOWERS GAINED######################-->

            <div class="box p-4 mb-4">
                <div class="row">
                    <div class="col-4">
                        <p class="font-weight-500">New Followers</p>
                        <h4 class="text-success font-weight-bold" th:if="*{followersGained} >= 0" th:text="*{followersGained}"></h4>
                        <h4 class="text-danger font-weight-bold" th:unless="*{followersGained} >= 0" th:text="*{followersGained}"></h4>
                    </div>
                    <div class="col-4 border-left">
                        <p class="font-weight-500">New Followers Today</p>
                        <h4 class="text-success font-weight-bold" th:if="${newFollowersToday} >= 0" th:text="${newFollowersToday}"></h4>
                        <h4 class="text-danger font-weight-bold" th:unless="${newFollowersToday} >= 0" th:text="${newFollowersToday}"></h4>
                    </div>
                    <div class="col-4 border-left">
                        <p class="font-weight-500">Next Post at:</p>
                        <!--<h4 class="text-info font-weight-bold" th:text="'17:00'"></h4>-->
                        <h4 class="text-info font-weight-bold" th:text="'N/A'"></h4>
                    </div>
                </div>
            </div>

            <!--####################STATS######################-->
            <div class="box p-4 mb-4">

                <div class="row mb-4">
                    <div class="col">
                        <p class="font-weight-500 text-left">Followers Statistics</p>
                    </div>
                    <div class="col text-right">
                        <div class="dropdown text-right">
                            <button class="btn btn-secondary btn-sm dropdown-toggle bg-primary text-white" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" th:text="${'Date: ' + dates}"></button>
                            <div class="dropdown-menu bg-primary-light" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" th:href="@{'/account/' + ${account.username} + '?d=7'}">Last: 7 days</a>
                                <a class="dropdown-item" th:href="@{'/account/' + ${account.username} + '?d=28'}">Last 28 days</a>
                                <a class="dropdown-item" th:href="@{'/account/' + ${account.username} + '?d=90'}">Last 90 days</a>
                            </div>
                        </div>
                    </div>
                </div>

                <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script>
                <div th:replace="layouts/graphs :: stats"></div>
            </div>

            <div class="row">

                <!--####################LATEST FOLLOWERS######################-->
                <div class="col-12 col-md-6">
                    <div class="box p-4 mb-4">
                        <p class="font-weight-500 text-left">Latest Followers</p>
                        <div class="activity mb-3" style="max-height:200px;">
                            <p th:if="${latestFollowers.isEmpty()}" class="text-secondary text-center my-5">No followers gained...</p>

                            <div th:unless="${latestFollowers.isEmpty()}" th:each="follower : ${latestFollowers}">
                                <p th:text="${follower.username}"></p>
                            </div>

                        </div>

                        <!-- Button trigger modal -->
                        <button type="button" class="btn btn-outline-primary btn-block font-weight-500" data-toggle="modal" data-target="#allFollowers">
                            View All
                        </button>

                        <!-- Modal -->
                        <div class="modal fade" id="allFollowers" tabindex="-1" role="dialog" aria-hidden="true">
                            <div class="modal-dialog" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title">All Followers</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <p th:if="${allFollowers.isEmpty()}" class="text-secondary text-center my-5">No followers gained...</p>
                                        <div th:unless="${allFollowers.isEmpty()}" style="max-height:600px; overflow-y: auto;">
                                            <p th:each="follower : ${allFollowers}" th:text="${follower.username}"></p>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

                <!--####################SCHEDULED POSTS######################-->
                <div class="col-12 col-md-6">
                    <div class="box p-4 mb-4">
                        <p class="font-weight-500 text-left">Scheduled Posts</p>
                        <div class="activity mb-3" style="max-height:200px;">
                            <!--<p class="text-secondary text-center my-5">No actions completed...</p>-->
                            <p class="text-secondary text-center my-5">Coming soon</p>
                        </div>
                        <a href="#" role="button" class="btn btn-outline-info btn-block font-weight-500">View All</a>
                    </div>
                </div>
            </div>


        </div>

    </div>

</div>

<footer th:replace="layouts/layout :: footer"></footer>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>


</body>

</html>